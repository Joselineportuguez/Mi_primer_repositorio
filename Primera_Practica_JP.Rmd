---
title: "Primera_Practica_JP"
author: "Joseline Portuguez L"
date: "2023-07-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(readxl)
library(tidyr)
library(janitor) 
library(lubridate)
library(hms)
```

A.

```{r}
datos_netflix_info <-read_csv2("https://raw.githubusercontent.com/isa229/programacion_analisis_datos_ii/main/netflix_info.csv")
```

B. Ajuste los nombres de las columnas para que estén en español.

```{r}
datos_netflix_info <- datos_netflix_info |> 
  rename("ID"="show_id","Tipo"="type","Titulo"="title","Director"="director","Pais"="country","Fecha_agregacion"="date_added","Año_lanzamiento"="release_year","Clasificacion"="rating","Duracion"="duration","Categoria"="listed_in")
```

C. Elimine filas duplicadas.

```{r}
datos_netflix_info <- datos_netflix_info |> 
distinct()
```

D. Eliminar filas y columnas vacías.

```{r}
datos_netflix_info <- datos_netflix_info|> 
  remove_empty(which = c("rows", "cols"))
```

E. Elimine la variable correspondiente al año de lanzamiento (release_year.)

```{r}
datos_netflix_info <- select(datos_netflix_info, -Año_lanzamiento)
```

F. Haga una inspección de las variables type y country para determinar si hay observaciones mal escritas o escritas de diferentes maneras. Si es ahí, haga la limpieza para poder homogenizar esos datos.

```{r}
datos_netflix_info <- datos_netflix_info  |>
  mutate(across(c(Tipo), function(x) ifelse(x == "movie", "Movie", x))) |>
  mutate(across(c(Tipo), function(x) ifelse(x == "tv show", "TV Show", x))) |>
  mutate(across(c(Tipo), function(x) ifelse(x == "Movi", "Movie", x))) |> 
  mutate(across(c(Tipo), function(x) ifelse(x == "TV SHOW", "TV Show", x)))
```

```{r}
datos_netflix_info <- datos_netflix_info  |>
  mutate(Pais = ifelse(Pais == "united states", "United States", Pais)) |> 
  mutate(Pais = ifelse(Pais == "india", "India", Pais)) |> 
  mutate(pais = ifelse(Pais == "pakistan", "Pakistan", Pais)) |> 
  mutate(pais = ifelse(Pais == "canada", "Canada", Pais))
```

```{r}
datos_netflix_info <- select(datos_netflix_info, -pais)
```

G. Para todas las columnas de tipo carácter, en donde haya NA, coloque “Sin información”.

```{r}
datos_netflix_info <- datos_netflix_info |> 
  mutate(Tipo = replace_na(Tipo, "Sin información"),
         Titulo = replace_na(Titulo, "Sin información"),
         Director = replace_na(Director, "Sin información"),
         Pais = replace_na(Pais, "Sin información"),
         Fecha_agregacion = replace_na(Fecha_agregacion, "Sin información"),
         Clasificacion = replace_na(Clasificacion, "Sin información"),
         Duracion = replace_na(Duracion, "Sin información"),
         Categoria = replace_na(Categoria, "Sin información"))
```

